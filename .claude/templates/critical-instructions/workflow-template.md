# Workflow Command - CRITICAL INSTRUCTION Template

이 템플릿은 Workflow 타입 슬래시 명령어에 적용됩니다.
- 적용 대상: `/epic`, `/major`, `/minor`, `/micro`

---

## 템플릿 내용

```markdown
**Claude를 위한 필수 지시사항:**

이 명령어가 실행될 때 반드시 다음 단계를 **순서대로** 따라야 합니다:

1. **아직 코드를 작성하지 마세요**
2. 대화 맥락에서 [요구사항/이슈 설명]을 수집하세요
3. 영향받는 파일을 읽어 근본 원인을 분석하세요
4. reusability-enforcer skill을 사용하여 재사용 가능한 패턴을 검색하세요
5. **[문서-경로] 문서를 생성하세요**
6. 구현하기 전에 사용자 승인을 기다리세요

**절대로 [문서-이름] 생성 단계를 건너뛰지 마세요.**

---
```

## 명령어별 커스터마이징

### `/epic`
- [요구사항/이슈 설명] → epic 비전과 범위
- [문서-경로] → `.specify/epics/NNN-epic-name/epic-plan.md`
- [문서-이름] → epic-plan.md

### `/major`
- [요구사항/이슈 설명] → 기능 요구사항
- [문서-경로] → `.specify/features/NNN-name/spec.md, plan.md, tasks.md`
- [문서-이름] → 문서 (spec.md, plan.md, tasks.md)

### `/minor`
- [요구사항/이슈 설명] → 이슈 설명
- [문서-경로] → `.specify/specs/fixes/NNN-issue-name/fix-analysis.md`
- [문서-이름] → fix-analysis.md

### `/micro`
- 문서 생성 단계 불필요 (바로 구현)
- 대신 "변경사항이 정말 micro인지 확인" 단계 강조

## 핵심 원칙

1. **DO NOT write code yet** 문구 필수
2. **NEVER skip [문서명]** 문구 필수
3. 문서 생성 단계를 명시적으로 포함
4. 사용자 승인 대기 단계 포함
5. 재사용성 검색 단계 포함

---

## 📋 다음 단계 추천 시 필수 규칙

### 규칙 1: AskUserQuestion 사용 강제

명령어 실행 중 또는 완료 후, **사용자에게 다음 단계를 물어보거나 선택을 요청할 때**,
반드시 AskUserQuestion 도구를 사용하세요.

#### ❌ 잘못된 예시
```
"구현이 완료되었습니다. 이제 변경사항을 커밋하시겠습니까?"
"다음으로 /pr을 실행하시겠습니까? (예/아니오)"
```

#### ✅ 올바른 예시
```
"구현이 완료되었습니다."

[AskUserQuestion 호출]
{
  "questions": [{
    "question": "변경사항을 커밋하시겠습니까?",
    "header": "다음 단계",
    "multiSelect": false,
    "options": [
      {
        "label": "예, /commit 실행",
        "description": "변경사항을 즉시 커밋합니다"
      },
      {
        "label": "나중에 수동으로",
        "description": "지금은 건너뛰고 나중에 직접 실행합니다"
      }
    ]
  }]
}
```

#### 적용 시점
- ✅ 다음 단계를 **물어볼 때** (예/아니오 선택 필요)
- ✅ 여러 옵션 중 **선택을 요청할 때**
- ✅ 워크플로우 **전환을 제안할 때**
- ⚠️ 단순 정보 제공("다음은 /commit을 실행하세요")은 선택 사항

---

### 규칙 2: AskUserQuestion 응답 후 자동 실행

AskUserQuestion으로 사용자 응답을 받은 후, **반드시 다음 규칙을 따르세요**:

#### 사용자가 "예" 또는 "실행" 옵션 선택 시
→ **즉시 해당 슬래시 커맨드를 실행하세요**

**구현 방법**:
```javascript
// AskUserQuestion 응답 예시
{"0": "예, /commit 실행"}

// 다음 행동
SlashCommand("/commit")
```

**잘못된 예시**:
```
❌ "알겠습니다. /commit을 실행하려면 '/commit'을 입력하세요."
❌ "네, 그럼 커밋을 진행하겠습니다." (그리고 아무것도 안 함)
```

**올바른 예시**:
```
✅ "알겠습니다. 커밋을 진행하겠습니다."
   [SlashCommand("/commit") 즉시 호출]
```

#### 사용자가 "아니오" 또는 "나중에" 옵션 선택 시
→ 명령어 실행하지 않고 종료
→ 간단한 안내 메시지만 출력

**예시**:
```
"알겠습니다. 준비되시면 언제든 /commit을 실행하실 수 있습니다."
```

---

### 규칙 3: 응답 해석 패턴

사용자 응답에서 의도를 정확히 파악하세요:

**실행 의도 키워드**:
- "예", "실행", "진행", "바로", "즉시", "Yes"

**거부 의도 키워드**:
- "아니오", "나중에", "수동", "건너뛰기", "No"

**예시**:
```javascript
응답: {"0": "예, /commit 실행"}  → SlashCommand("/commit")
응답: {"0": "커밋 진행"}         → SlashCommand("/commit")
응답: {"0": "나중에 수동으로"}   → 실행 안 함
```

---

### Workflow 타입 명령어의 일반적인 다음 단계

#### `/epic` → `/major`
- Epic 계획 완료 후 첫 번째 Major 기능 구현 제안

#### `/major` → `/commit`
- 구현 완료 및 변경사항 있을 때 커밋 제안

#### `/minor` → `/commit`
- 버그 수정 완료 및 변경사항 있을 때 커밋 제안

#### `/micro` → `/commit`
- 간단한 수정 완료 후 커밋 제안

---

### 전체 워크플로우 예시

```
1. /major 명령어 실행
2. 문서 생성 (spec.md, plan.md, tasks.md)
3. 구현 완료
4. Claude: "구현이 완료되었습니다. 3개 파일이 수정되었습니다."
5. Claude: AskUserQuestion 호출
   - 질문: "변경사항을 커밋하시겠습니까?"
   - 옵션: ["예, /commit 실행", "나중에"]
6. 사용자: "예, /commit 실행" 클릭
7. AskUserQuestion 응답: {"0": "예, /commit 실행"}
8. Claude: "커밋을 진행하겠습니다."
9. Claude: SlashCommand("/commit") 즉시 실행
10. /commit 명령어 실행 시작
```

---

### 이점
1. **사용자 편의성**: 클릭만으로 워크플로우 진행
2. **자동화**: 수동 타이핑 불필요
3. **최소 개입**: 전체 워크플로우가 클릭 몇 번으로 완료
4. **명확성**: 각 단계에서 선택권 제공

# Major Workflow Configuration
# 신규 기능 추가, 아키텍처 변경 (2일 이상)

extends: "_base.yaml"

# ============================================================================
# COMMAND INFO
# ============================================================================

command: "major"
type: "workflow"
workflow_definition: "workflow-gates.json#/workflows/major"

description: "신규 기능 추가, 아키텍처 변경, API 엔드포인트 추가"

# ============================================================================
# PREREQUISITES
# ============================================================================

prerequisites:
  - git
  - node
  - yarn

# ============================================================================
# WORKFLOW SETTINGS
# ============================================================================

workflow:
  quality_level: "highest"
  estimated_token_savings: "60%"

  # Quality gates
  gates:
    pre_implementation:
      - "reusability-search"
      - "spec-quality"
      - "test-plan"

    during_implementation:
      - "reusability-check"
      - "architect-unified"
      - "test-first"
      - "type-safety"

    post_implementation:
      - "reusability-metrics"
      - "code-review"
      - "all-tests-pass"
      - "build-success"

# ============================================================================
# AGENTS & SKILLS
# ============================================================================

agents:
  - "architect-unified"
  - "implementer-unified"
  - "reviewer-unified"

skills:
  - "reusability-enforcer"
  - "reusability-metrics"

# ============================================================================
# USER PROMPTS (AskUserQuestion)
# ============================================================================

prompts:
  requirements_collection:
    - question: "기능 요구사항을 어떻게 수집하시겠습니까?"
      header: "요구사항 수집"
      multiSelect: false
      options:
        - label: "대화형으로 수집"
          description: "Claude와 대화하며 요구사항을 정리합니다"
        - label: "문서 기반"
          description: "기존 문서나 이슈에서 요구사항을 추출합니다"
        - label: "템플릿 사용"
          description: "미리 정의된 템플릿을 사용합니다"

    - question: "어느 브랜치를 병합 대상으로 하시겠습니까?"
      header: "병합 대상"
      multiSelect: false
      options:
        - label: "main"
          description: "메인 브랜치 (프로덕션)"
        - label: "develop"
          description: "개발 브랜치"
        - label: "기타"
          description: "다른 브랜치 지정"

# ============================================================================
# SPEC FILES
# ============================================================================

spec_files:
  directory: ".specify/"
  files:
    - "spec.md"
    - "plan.md"
    - "tasks.md"

# ============================================================================
# NEXT COMMANDS (다음 단계 추천)
# ============================================================================

next_commands:
  enabled: true
  auto_prompt: true

  recommendations:
    - command: "/commit"
      trigger: "on_success"
      condition: "git diff --staged --quiet; [ $? -ne 0 ]"
      priority: 1
      auto_execute: false
      description: "구현된 기능을 커밋합니다"

{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "version": "3.3.1",
  "description": "워크플로우별 품질 게이트 설정",
  "note": "이 파일은 Workflow 명령어(epic, major, minor, micro)의 품질 게이트만 정의합니다. Utility 명령어 설정은 .claude/commands-config/*.yaml에 정의됩니다.",
  "workflows": {
    "major": {
      "name": "Major (Unified Workflow)",
      "description": "신규 기능 추가, 아키텍처 변경, API 엔드포인트 추가",
      "triggers": [
        "2일 이상 소요 예상",
        "3개 이상 새 파일 생성",
        "API 엔드포인트 추가",
        "아키텍처 변경"
      ],
      "process": [
        "/start (프로젝트 첫 실행 시)",
        "/major [feature-name] (통합 워크플로)",
        "또는 단계별:",
        "/major-specify [feature-name]",
        "/major-clarify [feature-number]",
        "/major-plan [feature-number]",
        "/major-tasks [feature-number]",
        "/major-implement [feature-number] (선택)"
      ],
      "gates": {
        "pre-implementation": {
          "reusability-search": {
            "enabled": true,
            "required": true,
            "description": "기존 재사용 가능 모듈 검색",
            "skill": "reusability-enforcer",
            "criteria": [
              "shared/ui/* 컴포넌트 검색",
              "shared/lib/* 유틸리티 검색",
              "entities/*/ui/* 도메인 컴포넌트 검색",
              "features/* 유사 패턴 검색",
              "재사용 가능 모듈 목록 생성"
            ]
          },
          "spec-quality": {
            "enabled": true,
            "required": true,
            "description": "spec.md 품질 검증",
            "criteria": [
              "목표 명확성",
              "성공 기준 정의",
              "기술 스택 명시"
            ]
          },
          "test-plan": {
            "enabled": true,
            "required": true,
            "description": "테스트 계획 수립",
            "criteria": [
              "단위 테스트 계획",
              "통합 테스트 계획",
              "커버리지 목표 80%+"
            ]
          },
          "api-contract": {
            "enabled": true,
            "required": false,
            "description": "API 계약 정의 (API 관련 시만)",
            "criteria": [
              "Request/Response 타입",
              "에러 응답 형식",
              "MSW 핸들러"
            ]
          }
        },
        "during-implementation": {
          "reusability-check": {
            "enabled": true,
            "required": true,
            "description": "재사용성 검사 및 패턴 일관성",
            "skill": "reusability-enforcer",
            "criteria": [
              "기존 패턴 검색 완료",
              "패턴 일관성 확보",
              "중복 코드 5% 이하"
            ]
          },
          "architect-unified": {
            "enabled": true,
            "required": true,
            "description": "아키텍처 준수",
            "agent": "architect-unified",
            "criteria": [
              "Entity 순수성",
              "Features Props 규칙",
              "의존성 방향"
            ]
          },
          "test-first": {
            "enabled": true,
            "required": true,
            "description": "테스트 우선 개발",
            "agent": "implementer-unified",
            "criteria": [
              "구현 전 테스트 작성",
              "테스트 통과 확인",
              "커버리지 80%+ 달성"
            ]
          },
          "type-safety": {
            "enabled": true,
            "required": true,
            "description": "타입 안전성",
            "command": "yarn type-check",
            "criteria": [
              "TypeScript strict 모드",
              "타입 에러 없음"
            ]
          }
        },
        "post-implementation": {
          "reusability-metrics": {
            "enabled": true,
            "required": false,
            "description": "재사용성 메트릭 측정",
            "skill": "reusability-metrics",
            "criteria": [
              "재사용률 60% 이상",
              "중복 코드 5% 이하",
              "shared 컴포넌트 활용"
            ]
          },
          "code-review": {
            "enabled": true,
            "required": true,
            "description": "자동 코드 리뷰",
            "agent": "reviewer-unified",
            "criteria": [
              "보안 취약점 없음",
              "성능 이슈 없음",
              "베스트 프랙티스 준수"
            ]
          },
          "all-tests-pass": {
            "enabled": true,
            "required": true,
            "description": "전체 테스트 통과",
            "commands": [
              "yarn test",
              "yarn test:critical"
            ],
            "criteria": [
              "모든 테스트 통과",
              "커버리지 80%+"
            ]
          },
          "build-success": {
            "enabled": true,
            "required": true,
            "description": "빌드 성공",
            "command": "yarn build:dev",
            "criteria": [
              "빌드 에러 없음",
              "번들 크기 확인"
            ]
          }
        }
      },
      "estimated_token_savings": "60%",
      "quality_level": "highest"
    },
    "minor": {
      "name": "Minor (Lightweight)",
      "description": "버그 픽스, 기존 기능 개선, UI 스타일 변경",
      "triggers": [
        "1일 이하 소요",
        "로직 수정",
        "UI 개선"
      ],
      "process": [
        "/minor [feature-number-or-description]",
        "또는:",
        "Sub-agent 직접 호출 (quick-fixer, fsd-architect)",
        "Skill 활용 (bug-fix-pattern, fsd-component-creation)"
      ],
      "gates": {
        "pre-implementation": {
          "quick-reusability-check": {
            "enabled": true,
            "required": false,
            "description": "빠른 재사용성 체크",
            "skill": "reusability-enforcer",
            "criteria": [
              "관련 유틸리티 함수 검색",
              "버그 패턴 DB 확인",
              "기존 수정 사례 참조"
            ]
          },
          "issue-identification": {
            "enabled": true,
            "required": true,
            "description": "문제 식별",
            "criteria": [
              "재현 가능한 버그 설명",
              "영향 범위 파악"
            ]
          }
        },
        "during-implementation": {
          "minimal-change": {
            "enabled": true,
            "required": true,
            "description": "최소 변경 원칙",
            "agent": "implementer-unified",
            "criteria": [
              "변경 범위 최소화",
              "Side effect 검증"
            ]
          },
          "architect-unified": {
            "enabled": true,
            "required": true,
            "description": "규칙 준수",
            "agent": "architect-unified",
            "criteria": [
              "레이어 규칙 위반 없음"
            ]
          },
          "type-check": {
            "enabled": true,
            "required": true,
            "description": "타입 체크",
            "command": "yarn type-check",
            "criteria": [
              "타입 에러 없음"
            ]
          }
        },
        "post-implementation": {
          "related-tests": {
            "enabled": true,
            "required": true,
            "description": "관련 테스트 통과",
            "command": "yarn test [affected]",
            "criteria": [
              "수정된 파일 관련 테스트 통과"
            ]
          },
          "regression-check": {
            "enabled": true,
            "required": false,
            "description": "회귀 테스트 (선택)",
            "command": "yarn test:critical",
            "criteria": [
              "Critical path 테스트 통과"
            ]
          }
        }
      },
      "estimated_token_savings": "75%",
      "quality_level": "high"
    },
    "micro": {
      "name": "Micro (Quick Fix)",
      "description": "타이포 수정, 주석, 로그 제거, 설정 파일",
      "triggers": [
        "30분 이하 소요",
        "문서 수정",
        "주석 추가/제거",
        "설정 변경"
      ],
      "process": [
        "/micro [description]",
        "또는:",
        "직접 수정 (AI 최소 개입)"
      ],
      "gates": {
        "post-implementation": {
          "syntax-check": {
            "enabled": true,
            "required": true,
            "description": "문법 체크",
            "command": "yarn lint",
            "criteria": [
              "Lint 에러 없음"
            ]
          },
          "build-verify": {
            "enabled": false,
            "required": false,
            "description": "빌드 검증 (선택)",
            "command": "yarn build:dev",
            "criteria": [
              "빌드 성공"
            ]
          }
        }
      },
      "estimated_token_savings": "85%",
      "quality_level": "standard"
    },
    "epic": {
      "name": "Epic (Large Initiative)",
      "description": "여러 major를 포함하는 대규모 프로젝트, 1개월 이상 소요",
      "triggers": [
        "1개월 이상 소요 예상",
        "여러 팀 협업 필요",
        "5개 이상의 major 작업 포함",
        "전사적 영향 또는 아키텍처 대변경"
      ],
      "process": [
        "/epic [epic-name]",
        "Epic 범위 및 목표 정의",
        "하위 major/minor 작업 세분화",
        "마일스톤 및 일정 수립",
        "진행 상황 추적 및 조정"
      ],
      "gates": {
        "pre-implementation": {
          "epic-planning": {
            "enabled": true,
            "required": true,
            "description": "Epic 계획 수립",
            "criteria": [
              "Epic 목표 및 범위 명확히 정의",
              "성공 기준 (Success Criteria) 수립",
              "주요 마일스톤 식별",
              "의존성 및 위험 요소 파악"
            ]
          },
          "stakeholder-approval": {
            "enabled": true,
            "required": true,
            "description": "이해관계자 승인",
            "criteria": [
              "프로젝트 범위 합의",
              "리소스 배정 승인",
              "우선순위 확인"
            ]
          },
          "work-breakdown": {
            "enabled": true,
            "required": true,
            "description": "작업 분해 구조",
            "criteria": [
              "Major 작업 단위로 분해",
              "각 작업별 예상 시간 산정",
              "작업 간 의존성 매핑"
            ]
          },
          "technical-feasibility": {
            "enabled": true,
            "required": true,
            "description": "기술적 실현 가능성 검증",
            "criteria": [
              "기술 스택 선정",
              "PoC 또는 Spike 완료",
              "아키텍처 검토"
            ]
          }
        },
        "during-implementation": {
          "milestone-tracking": {
            "enabled": true,
            "required": true,
            "description": "마일스톤 진행 상황 추적",
            "criteria": [
              "주간 진행률 리포트",
              "마일스톤 달성 여부 확인",
              "블로커 및 리스크 관리"
            ]
          },
          "cross-team-sync": {
            "enabled": true,
            "required": true,
            "description": "팀 간 동기화",
            "criteria": [
              "정기적 동기화 미팅",
              "통합 이슈 해결",
              "커뮤니케이션 채널 유지"
            ]
          },
          "quality-gates-inherited": {
            "enabled": true,
            "required": true,
            "description": "하위 Major 작업의 품질 게이트 준수",
            "criteria": [
              "각 Major 작업이 major workflow gates 통과",
              "통합 테스트 통과",
              "전체 아키텍처 일관성 유지"
            ]
          }
        },
        "post-implementation": {
          "epic-review": {
            "enabled": true,
            "required": true,
            "description": "Epic 완료 후 회고",
            "criteria": [
              "목표 달성 여부 평가",
              "성공 요인 및 개선점 도출",
              "교훈 문서화"
            ]
          },
          "documentation-update": {
            "enabled": true,
            "required": true,
            "description": "문서 업데이트",
            "agent": "documenter-unified",
            "criteria": [
              "아키텍처 문서 업데이트",
              "README 및 가이드 갱신",
              "Changelog 작성"
            ]
          },
          "performance-validation": {
            "enabled": true,
            "required": true,
            "description": "성능 검증",
            "criteria": [
              "성능 목표 달성 확인",
              "부하 테스트 통과",
              "모니터링 설정 완료"
            ]
          }
        }
      },
      "estimated_token_savings": "40%",
      "quality_level": "highest"
    }
  },
  "common_gates": {
    "reusability": {
      "duplication_check": {
        "enabled": true,
        "required_for": [
          "major",
          "minor"
        ],
        "description": "코드 중복 기회 검사",
        "threshold": "10줄 이상 유사 코드",
        "skill": "reusability-metrics"
      },
      "component_search": {
        "enabled": true,
        "required": true,
        "description": "새 컴포넌트 생성 전 기존 컴포넌트 검색",
        "skill": "reusability-enforcer"
      },
      "abstraction_review": {
        "enabled": true,
        "required": false,
        "description": "새 코드의 추상화 가능성 검토",
        "criteria": [
          "2회 이상 사용 예상",
          "도메인 독립적",
          "적절한 문서화"
        ]
      },
      "metrics_tracking": {
        "enabled": true,
        "description": "재사용성 메트릭 추적",
        "skill": "reusability-metrics",
        "targets": {
          "reusability_rate": "60%",
          "duplication_rate": "< 5%",
          "shared_usage_per_feature": "10+"
        }
      }
    },
    "git": {
      "commit_message": {
        "enabled": true,
        "format": "conventional",
        "examples": [
          "feat: 운송 신청 기능 추가",
          "fix: 차량번호 검증 오류 수정",
          "docs: README 업데이트",
          "style: 코드 포맷팅",
          "refactor: useDispatch 훅 분리",
          "test: 운송 신청 테스트 추가"
        ]
      },
      "branch_naming": {
        "enabled": true,
        "patterns": [
          "feature/*",
          "fix/*",
          "refactor/*",
          "docs/*"
        ]
      }
    },
    "documentation": {
      "changelog": {
        "enabled": true,
        "required_for": [
          "major"
        ],
        "agent": "documenter-unified"
      },
      "notion_update": {
        "enabled": true,
        "required_for": [],
        "skill": "daily-changelog-notion"
      }
    }
  },
  "override": {
    "description": "특정 상황에서 게이트 우회 가능 (신중히 사용)",
    "allowed_overrides": [
      "hotfix (프로덕션 긴급 수정)",
      "experimental (실험적 기능)",
      "prototype (프로토타입)"
    ],
    "require_justification": true
  }
}